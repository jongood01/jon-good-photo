---
import { Image } from 'astro:assets'
import { getCollection } from 'astro:content'
import Layout from '../../layouts/Layout.astro'

export async function getStaticPaths() {
  const photos = await getCollection('photos')
  return photos.map((photo) => ({
    params: { id: photo.data.id },
    props: { photo }
  }))
}

const { photo } = Astro.props
---

<Layout title={photo.data.title}>
  <main class="min-h-screen bg-slate-50 py-20">
    <div class="container mx-auto px-6 max-w-4xl">
      <div class="flex flex-col items-center">
        <div class="w-full max-w-3xl">
          <Image
            src={photo.data.file}
            alt={photo.data.altText}
            widths={
              photo.data.aspectRatio === '1:1'
                ? [650, 1300, 1950]
                : photo.data.aspectRatio === '3:2'
                  ? [975, 1950, 2925]
                  : photo.data.aspectRatio === '16:9'
                    ? [1156, 2312, 3468]
                    : [650, 1300, 1950]
            }
            sizes="(max-width: 768px) 100vw, (max-width: 1200px) 75vw, 1200px"
            quality={'high'}
            class="w-full h-auto object-contain"
          />
        </div>
        
        <div class="mt-8 text-center max-w-2xl">
          <h1 class="text-3xl font-bold mb-4">{photo.data.title}</h1>
          <p class="text-lg text-gray-600 mb-6">{photo.data.description}</p>
          
          <div class="flex justify-center space-x-8 text-sm text-gray-500">
            <div>
              <span class="font-medium">Format:</span> {photo.data.format}
            </div>
            <div>
              <span class="font-medium">Aspect Ratio:</span> {photo.data.aspectRatio}
            </div>
          </div>
          
          <div class="mt-4 text-xs text-gray-400">
            Collection {photo.data.collectionIndex} • Category {photo.data.categoryIndex} • Image {photo.data.imageIndex}
          </div>
        </div>
        
        <div class="mt-12">
          <a 
            href="/" 
            class="inline-flex items-center px-6 py-3 bg-black text-white rounded-md hover:bg-gray-800 transition-colors"
          >
            ← Back to Gallery
          </a>
        </div>
      </div>
    </div>
  </main>
</Layout>